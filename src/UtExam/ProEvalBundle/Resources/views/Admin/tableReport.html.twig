{% block table %}
{% set CalifiE1 = 0 %}
{% set CalifiE2 = 0 %}
{% set CalifiE3 = 0 %}
{% set CalificacionGE = 0 %}
{% set PromedioE = 0 %}
{% set CalifiS1 = 0 %}
{% set CalifiS2 = 0 %}
{% set CalifiS3 = 0 %}
{% set CalificacionGS = 0 %}
{% set PromedioS = 0 %}
{% set AlumnosPGE1 = 0 %}
{% set AlumnosPGE2 = 0 %}
{% set AlumnosPGE3 = 0 %}
{% set AlumnosPGS1 = 0 %}
{% set AlumnosPGS2 = 0 %}
{% set AlumnosPGS3 = 0 %}
{% set IntMaterias = 1 %}
{% set GruposPT = 0 %}
{% set Porcentaje = 0 %}
{% set CalificacionGET = 0 %}
{% set CalificacionGST = 0 %}
{% set CalifiTempo = 0 %}
{% set Maestro1 = "" %}
{% set Maestro2 = "" %}
{% set Maestro3 = "" %}
{% set NombreMateria1 = "" %}
{% set NombreMateria2 = "" %}
{% set NombreMateria3 = "" %}
<div class="span7">
  <div class="widget stacked widget-table action-table">
    {% if generacion is defined %}
      <div class="widget-header">
      	<i class="fa fa-list"></i>
      	<h3>Reporte Generacional</h3>
      </div>
    	<div class="widget-content table-responsive">
    		<table class="table table-striped table-bordered table-condensed table-hover">
    			<thead>
          {# agregando las materias y cuantas son #}
            {% for allAlumnos in GV %}
              {% if NombreMateria1 is empty %}
                {% if allAlumnos.calificacionE1 is not empty and allAlumnos.calificacionE1 is defined and allAlumnos.calificacionE1 != "0" and allAlumnos.calificacionE1 != ":=0" %}
                  {% set NombreMateria1 = allAlumnos.calificacionE1|split(':=')[0] %}
                  {% set IntMaterias = IntMaterias + 1 %}
                {% endif %}
                {% if NombreMateria2 is empty %}
                  {% if allAlumnos.calificacionE2 is not empty and allAlumnos.calificacionE2 is defined and allAlumnos.calificacionE2 != "0" and allAlumnos.calificacionE2 != ":=0" %}
                    {% set NombreMateria2 = allAlumnos.calificacionE2|split(':=')[0] %}
                    {% set IntMaterias = IntMaterias + 1 %}
                  {% endif %}
                {% endif %}
                {% if NombreMateria3 is empty %}
                  {% if allAlumnos.calificacionE3 is not empty and allAlumnos.calificacionE3 is defined and allAlumnos.calificacionE3 != "0" and allAlumnos.calificacionE3 != ":=0" %}
                    {% set NombreMateria3 = allAlumnos.calificacionE3|split(':=')[0] %}
                    {% set IntMaterias = IntMaterias + 1 %}
                  {% endif %}
                {% endif %}
              {% elseif NombreMateria2 is empty and NombreMateria2 != NombreMateria1 %}
                {% if allAlumnos.calificacionE2 is not empty and allAlumnos.calificacionE2 is defined and allAlumnos.calificacionE2 != "0" and allAlumnos.calificacionE2 != ":=0" %}
                  {% set NombreMateria2 = allAlumnos.calificacionE2|split(':=')[0] %}
                  {% set IntMaterias = IntMaterias + 1 %}
                {% endif %}
                {% if NombreMateria3 is empty and NombreMateria3 != NombreMateria1 %}
                  {% if allAlumnos.calificacionE3 is not empty and allAlumnos.calificacionE3 is defined and allAlumnos.calificacionE3 != "0" and allAlumnos.calificacionE3 != ":=0" %}
                    {% set NombreMateria3 = allAlumnos.calificacionE3|split(':=')[0] %}
                    {% set IntMaterias = IntMaterias + 1 %}
                  {% endif %}
                {% endif %}
              {% elseif NombreMateria3 is empty and NombreMateria3 != NombreMateria2 and NombreMateria3 != NombreMateria1 %}
                {% if allAlumnos.calificacionE3 is not empty and allAlumnos.calificacionE3 is defined and allAlumnos.calificacionE3 != "0" and allAlumnos.calificacionE3 != ":=0" %}
                  {% set NombreMateria3 = allAlumnos.calificacionE3|split(':=')[0] %}
                  {% set IntMaterias = IntMaterias + 1 %}
                {% endif %}
              {% endif %}
            {% endfor %}
    				<tr>
              <th>Turno</th>
    					<th>Grupo</th>
              <th colspan="{{IntMaterias}}">Calificacion de Entrada</th>
              <th colspan="{{IntMaterias}}">Calificacion de Salida</th>
    					<th colspan="{{IntMaterias - 1}}">Maestro a cargo</th>
              <th>Porcentaje de mejora</th>
              <th colspan="{{IntMaterias - 1}}">Porcentaje de mejora por materia</th>
    				</tr>
            <tr>
              <th>||</th>
    					<th>||</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
              <th>Promedio</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
              <th>Promedio</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
              <th>%</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
    				</tr>
    			</thead>
    			<tbody>
            <tr>
              <td rowspan="{{gruposV|length + 1}}">Matutino</td>
            </tr>
            {% for grupo in gruposV %}
              {% for alumno in GV %}
                {% if alumno.turno == "Vespertino" %}
                  {% if alumno.grupo == grupo.grupo %}
                    {% if alumno.calificacionE1 is not empty and alumno.calificacionE1 is defined and alumno.calificacionE1 != "0" and alumno.calificacionE1 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionE1|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                      {% endif %}
                      {% if alumno.maestros[0] is defined and alumno.maestros[0] is not empty %}
                        {% if NombreMateria1 == alumno.maestros[0].materias.nombre %}
                          {% set Maestro1 = alumno.maestros[0].nombre %}
                        {% elseif NombreMateria2 == alumno.maestros[0].materias.nombre %}
                          {% set Maestro2 = alumno.maestros[0].nombre %}
                        {% elseif NombreMateria3 == alumno.maestros[0].materias.nombre %}
                          {% set Maestro3 = alumno.maestros[0].nombre %}
                        {% endif %}
                      {% endif %}
                      {% set AlumnosPGE1 = AlumnosPGE1 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionE2 is not empty and alumno.calificacionE2 is defined and alumno.calificacionE2 != "0" and alumno.calificacionE2 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionE2|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                      {% endif %}
                      {% if alumno.maestros[1] is defined and alumno.maestros[1] is not empty %}
                        {% if NombreMateria1 == alumno.maestros[1].materias.nombre %}
                          {% set Maestro1 = alumno.maestros[1].nombre %}
                        {% elseif NombreMateria2 == alumno.maestros[1].materias.nombre %}
                          {% set Maestro2 = alumno.maestros[1].nombre %}
                        {% elseif NombreMateria3 == alumno.maestros[1].materias.nombre %}
                          {% set Maestro3 = alumno.maestros[1].nombre %}
                        {% endif %}
                      {% endif %}
                      {% set AlumnosPGE2 = AlumnosPGE2 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionE3 is not empty and alumno.calificacionE3 is defined and alumno.calificacionE3 != "0" and alumno.calificacionE3 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionE3|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                      {% endif %}
                      {% if alumno.maestros[2] is defined and alumno.maestros[2] is not empty %}
                        {% if NombreMateria1 == alumno.maestros[2].materias.nombre %}
                          {% set Maestro1 = alumno.maestros[2].nombre %}
                        {% elseif NombreMateria2 == alumno.maestros[2].materias.nombre %}
                          {% set Maestro2 = alumno.maestros[2].nombre %}
                        {% elseif NombreMateria3 == alumno.maestros[2].materias.nombre %}
                          {% set Maestro3 = alumno.maestros[2].nombre %}
                        {% endif %}
                      {% endif %}
                      {% set AlumnosPGE3 = AlumnosPGE3 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionS1 is not empty and alumno.calificacionS1 is defined and alumno.calificacionS1 != "0" and alumno.calificacionS1 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionS1|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                      {% endif %}
                      {% set AlumnosPGS1 = AlumnosPGS1 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionS2 is not empty and alumno.calificacionS2 is defined and alumno.calificacionS2 != "0" and alumno.calificacionS2 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionS2|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                      {% endif %}
                      {% set AlumnosPGS2 = AlumnosPGS2 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionS3 is not empty and alumno.calificacionS3 is defined and alumno.calificacionS3 != "0" and alumno.calificacionS3 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionS3|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                      {% endif %}
                      {% set AlumnosPGS3 = AlumnosPGS3 + 1 %}
                    {% endif %}
                  {% endif %}
                {% endif %}
              {% endfor %}
              <tr>
                <td>{{grupo.grupo}}</td>
                {% if CalifiE1 != 0 %}
                {% set CalifiE1 = CalifiE1 / AlumnosPGE1 %}
                  <td>{{CalifiE1|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiE1}}</td>
                {% endif %}
                {% if CalifiE2 != 0 %}
                {% set CalifiE2 = CalifiE2 / AlumnosPGE2 %}
                  <td>{{CalifiE2|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiE2}}</td>
                {% endif %}
                {% if CalifiE3 != 0 %}
                {% set CalifiE3 = CalifiE3 / AlumnosPGE3 %}
                  <td>{{CalifiE3|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiE3}}</td>
                {% endif %}
                {% if (CalifiE1 + CalifiE2 + CalifiE3)  != 0 %}
                  {% set PromedioE = (CalifiE1 + CalifiE2 + CalifiE3) / (IntMaterias - 1) %}
                {% endif %}
                <td>{{PromedioE|slice(0, 5)}}</td>
                {% if CalifiS1 != 0 %}
                {% set CalifiS1 = CalifiS1 / AlumnosPGS1 %}
                  <td>{{CalifiS1|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiS1}}</td>
                {% endif %}
                {% if CalifiS2 != 0 %}
                {% set CalifiS2 = CalifiS2 / AlumnosPGS2 %}
                  <td>{{CalifiS2|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiS2}}</td>
                {% endif %}
                {% if CalifiS3 != 0 %}
                {% set CalifiS3 = CalifiS3 / AlumnosPGS3 %}
                  <td>{{CalifiS3|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiS3}}</td>
                {% endif %}
                {% if (CalifiS1 + CalifiS2 + CalifiS3) != 0 %}
                  {% set PromedioS = (CalifiS1 + CalifiS2 + CalifiS3) / (IntMaterias - 1) %}
                {% endif %}
                <td>{{PromedioS|slice(0, 5)}}</td>
                <td>{{Maestro1}}</td>
                <td>{{Maestro2}}</td>
                <td>{{Maestro3}}</td>
                {% set Porcentaje = PromedioS - PromedioE %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if PromedioE == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / PromedioE) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = PromedioE - PromedioS %}
                  {% if PromedioE == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / PromedioE) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# porsentajes para materia 1 #}
                {% set Porcentaje = CalifiS1 - CalifiE1 %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if CalifiE1 == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / CalifiE1) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = CalifiE1 - CalifiS1 %}
                  {% if CalifiE1 == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / CalifiE1) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# fin de porsentajes para materia 1 #}
                {# porsentajes para materia 2 #}
                {% set Porcentaje = CalifiS2 - CalifiE2 %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if CalifiE2 == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / CalifiE2) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = CalifiE2 - CalifiS2 %}
                  {% if CalifiE2 == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / CalifiE2) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# fin de porsentajes para materia 2 #}
                {# porsentajes para materia 3 #}
                {% set Porcentaje = CalifiS3 - CalifiE3 %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if CalifiE3 == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / CalifiE3) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = CalifiE3 - CalifiS3 %}
                  {% if CalifiE3 == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / CalifiE3) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# fin de porsentajes para materia 3 #}
                {% set AlumnosPGE1 = 0 %}
          			{% set AlumnosPGE2 = 0 %}
          			{% set AlumnosPGE3 = 0 %}
          			{% set AlumnosPGS1 = 0 %}
          			{% set AlumnosPGS2 = 0 %}
          			{% set AlumnosPGS3 = 0 %}
                {% set CalifiE1 = 0 %}
                {% set CalifiE2 = 0 %}
                {% set CalifiE3 = 0 %}
                {% set CalifiS1 = 0 %}
                {% set CalifiS2 = 0 %}
                {% set CalifiS3 = 0 %}
                {% set PromedioE = 0 %}
                {% set PromedioS = 0 %}

              </tr>
            {% endfor %}
      			{% set AlumnosPGE1 = 0 %}
      			{% set AlumnosPGE2 = 0 %}
      			{% set AlumnosPGE3 = 0 %}
      			{% set AlumnosPGS1 = 0 %}
      			{% set AlumnosPGS2 = 0 %}
      			{% set AlumnosPGS3 = 0 %}
            {% set CalifiE1 = 0 %}
            {% set CalifiE2 = 0 %}
            {% set CalifiE3 = 0 %}
            {% set CalifiS1 = 0 %}
            {% set CalifiS2 = 0 %}
            {% set CalifiS3 = 0 %}
            {% set PromedioE = 0 %}
            {% set PromedioS = 0 %}
            <tr>
              <td rowspan="{{gruposN|length + 1}}">Nocturno</td>
            </tr>
            {% for grupo in gruposN %}
              {% for alumno in GN %}
                {% if alumno.turno == "Nocturno" %}
                  {% if alumno.grupo == grupo.grupo %}
                    {% if alumno.calificacionE1 is not empty and alumno.calificacionE1 is defined and alumno.calificacionE1 != "0" and alumno.calificacionE1 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionE1|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                      {% endif %}
                      {% if alumno.maestros[0] is defined and alumno.maestros[0] is not empty %}
                        {% if NombreMateria1 == alumno.maestros[0].materias.nombre %}
                          {% set Maestro1 = alumno.maestros[0].nombre %}
                        {% elseif NombreMateria2 == alumno.maestros[0].materias.nombre %}
                          {% set Maestro2 = alumno.maestros[0].nombre %}
                        {% elseif NombreMateria3 == alumno.maestros[0].materias.nombre %}
                          {% set Maestro3 = alumno.maestros[0].nombre %}
                        {% endif %}
                      {% endif %}
                      {% set AlumnosPGE1 = AlumnosPGE1 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionE2 is not empty and alumno.calificacionE2 is defined and alumno.calificacionE2 != "0" and alumno.calificacionE2 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionE2|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                      {% endif %}
                      {% if alumno.maestros[1] is defined and alumno.maestros[1] is not empty%}
                        {% if NombreMateria1 == alumno.maestros[1].materias.nombre %}
                          {% set Maestro1 = alumno.maestros[1].nombre %}
                        {% elseif NombreMateria2 == alumno.maestros[1].materias.nombre %}
                          {% set Maestro2 = alumno.maestros[1].nombre %}
                        {% elseif NombreMateria3 == alumno.maestros[1].materias.nombre %}
                          {% set Maestro3 = alumno.maestros[1].nombre %}
                        {% endif %}
                      {% endif %}
                      {% set AlumnosPGE2 = AlumnosPGE2 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionE3 is not empty and alumno.calificacionE3 is defined and alumno.calificacionE3 != "0" and alumno.calificacionE3 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionE3|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                      {% endif %}
                      {% if alumno.maestros[2] is defined and alumno.maestros[2] is not empty %}
                        {% if NombreMateria1 == alumno.maestros[2].materias.nombre %}
                          {% set Maestro1 = alumno.maestros[2].nombre %}
                        {% elseif NombreMateria2 == alumno.maestros[2].materias.nombre %}
                          {% set Maestro2 = alumno.maestros[2].nombre %}
                        {% elseif NombreMateria3 == alumno.maestros[2].materias.nombre %}
                          {% set Maestro3 = alumno.maestros[2].nombre %}
                        {% endif %}
                      {% endif %}
                      {% set AlumnosPGE3 = AlumnosPGE3 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionS1 is not empty and alumno.calificacionS1 is defined and alumno.calificacionS1 != "0" and alumno.calificacionS1 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionS1|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                      {% endif %}
                      {% set AlumnosPGS1 = AlumnosPGS1 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionS2 is not empty and alumno.calificacionS2 is defined and alumno.calificacionS2 != "0" and alumno.calificacionS2 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionS2|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                      {% endif %}
                      {% set AlumnosPGS2 = AlumnosPGS2 + 1 %}
                    {% endif %}
                    {% if alumno.calificacionS3 is not empty and alumno.calificacionS3 is defined and alumno.calificacionS3 != "0" and alumno.calificacionS3 != ":=0" %}
                      {% set CalifiTempo = alumno.calificacionS3|split(':=') %}
                      {% if NombreMateria1 == CalifiTempo[0] %}
                        {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                        {% elseif NombreMateria2 == CalifiTempo[0] %}
                        {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                        {% elseif NombreMateria3 == CalifiTempo[0] %}
                        {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                      {% endif %}
                      {% set AlumnosPGS3 = AlumnosPGS3 + 1 %}
                    {% endif %}
                  {% endif %}
                {% endif %}
              {% endfor %}
              <tr>
                <td>{{grupo.grupo}}</td>
                {% if CalifiE1 != 0 %}
                {% set CalifiE1 = CalifiE1 / AlumnosPGE1 %}
                  <td>{{CalifiE1|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiE1}}</td>
                {% endif %}
                {% if CalifiE2 != 0 %}
                {% set CalifiE2 = CalifiE2 / AlumnosPGE2 %}
                  <td>{{CalifiE2|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiE2}}</td>
                {% endif %}
                {% if CalifiE3 != 0 %}
                {% set CalifiE3 = CalifiE3 / AlumnosPGE3 %}
                  <td>{{CalifiE3|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiE3}}</td>
                {% endif %}
                {% if (CalifiE1 + CalifiE2 + CalifiE3)  != 0 %}
                  {% set PromedioE = (CalifiE1 + CalifiE2 + CalifiE3) / (IntMaterias - 1) %}
                {% endif %}
                <td>{{PromedioE|slice(0, 5)}}</td>
                {% if CalifiS1 != 0 %}
                {% set CalifiS1 = CalifiS1 / AlumnosPGS1 %}
                  <td>{{CalifiS1|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiS1}}</td>
                {% endif %}
                {% if CalifiS2 != 0 %}
                {% set CalifiS2 = CalifiS2 / AlumnosPGS2 %}
                  <td>{{CalifiS2|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiS2}}</td>
                {% endif %}
                {% if CalifiS3 != 0 %}
                {% set CalifiS3 = CalifiS3 / AlumnosPGS3 %}
                  <td>{{CalifiS3|slice(0, 5)}}</td>
                {% else %}
                  <td>{{CalifiS3}}</td>
                {% endif %}
                {% if (CalifiS1 + CalifiS2 + CalifiS3) != 0 %}
                  {% set PromedioS = (CalifiS1 + CalifiS2 + CalifiS3) / (IntMaterias - 1) %}
                {% endif %}
                <td>{{PromedioS|slice(0, 5)}}</td>
                <td>{{Maestro1}}</td>
                <td>{{Maestro2}}</td>
                <td>{{Maestro3}}</td>
                {% set Porcentaje = PromedioS - PromedioE %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if PromedioE == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / PromedioE) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = PromedioE - PromedioS %}
                  {% if PromedioE == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / PromedioE) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# porsentajes para materia 1 #}
                {% set Porcentaje = CalifiS1 - CalifiE1 %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if CalifiE1 == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / CalifiE1) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = CalifiE1 - CalifiS1 %}
                  {% if CalifiE1 == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / CalifiE1) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# fin de porsentajes para materia 1 #}
                {# porsentajes para materia 2 #}
                {% set Porcentaje = CalifiS2 - CalifiE2 %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if CalifiE2 == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / CalifiE2) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = CalifiE2 - CalifiS2 %}
                  {% if CalifiE2 == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / CalifiE2) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# fin de porsentajes para materia 2 #}
                {# porsentajes para materia 3 #}
                {% set Porcentaje = CalifiS3 - CalifiE3 %}
                {% if Porcentaje >= 0 %}
                  {% if Porcentaje == 0 %}
                    <td>
                      {{Porcentaje}}%
                    </td>
                  {% else %}
                    <td class="text-success">
                  {% if CalifiE3 == 0 %}
                    {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    {{ ((Porcentaje / CalifiE3) * 100)|slice(0, 5) }}%
                  {% endif %}
                    </td>
                  {% endif %}
                {% else %}
                  <td class="text-danger" >
                  {% set Porcentaje = CalifiE3 - CalifiS3 %}
                  {% if CalifiE3 == 0 %}
                    -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                  {% else %}
                    -{{ ((Porcentaje / CalifiE3) * 100)|slice(0, 5) }}%
                  {% endif %}
                  </td>
                {% endif %}
                {# fin de porsentajes para materia 3 #}
                {% set AlumnosPGE1 = 0 %}
          			{% set AlumnosPGE2 = 0 %}
          			{% set AlumnosPGE3 = 0 %}
          			{% set AlumnosPGS1 = 0 %}
          			{% set AlumnosPGS2 = 0 %}
          			{% set AlumnosPGS3 = 0 %}
                {% set CalifiE1 = 0 %}
                {% set CalifiE2 = 0 %}
                {% set CalifiE3 = 0 %}
                {% set CalifiS1 = 0 %}
                {% set CalifiS2 = 0 %}
                {% set CalifiS3 = 0 %}
                {% set PromedioE = 0 %}
                {% set PromedioS = 0 %}
              </tr>
            {% endfor %}
            {% set CalifiE1 = 0 %}
            {% set CalifiE2 = 0 %}
            {% set CalifiE3 = 0 %}
            {% set CalifiS1 = 0 %}
            {% set CalifiS2 = 0 %}
            {% set CalifiS3 = 0 %}
            {% set PromedioE = 0 %}
            {% set PromedioS = 0 %}
    			</tbody>
    		</table>
    	</div>
    {% else %}
      <div class="widget-header">
      	<i class="fa fa-list"></i>
      	<h3>Reporte al Grupo {{nameGrupo}} del Tunro {{turno}} de la Generacion {{nameGeneracion}}.</h3>
      </div>
    	<div class="widget-content table-responsive">
    		<table class="table table-striped table-bordered table-condensed table-hover">
    			<thead>
          {# agregando las materias y cuantas son #}
            {% for allAlumnos in reporte %}
              {% if NombreMateria1 is empty %}
                {% if allAlumnos.calificacionE1 is not empty and allAlumnos.calificacionE1 is defined and allAlumnos.calificacionE1 != "0" and allAlumnos.calificacionE1 != ":=0" %}
                  {% set NombreMateria1 = allAlumnos.calificacionE1|split(':=')[0] %}
                  {% set IntMaterias = IntMaterias + 1 %}
                {% endif %}
                {% if NombreMateria2 is empty %}
                  {% if allAlumnos.calificacionE2 is not empty and allAlumnos.calificacionE2 is defined and allAlumnos.calificacionE2 != "0" and allAlumnos.calificacionE2 != ":=0" %}
                    {% set NombreMateria2 = allAlumnos.calificacionE2|split(':=')[0] %}
                    {% set IntMaterias = IntMaterias + 1 %}
                  {% endif %}
                {% endif %}
                {% if NombreMateria3 is empty %}
                  {% if allAlumnos.calificacionE3 is not empty and allAlumnos.calificacionE3 is defined and allAlumnos.calificacionE3 != "0" and allAlumnos.calificacionE3 != ":=0" %}
                    {% set NombreMateria3 = allAlumnos.calificacionE3|split(':=')[0] %}
                    {% set IntMaterias = IntMaterias + 1 %}
                  {% endif %}
                {% endif %}
              {% elseif NombreMateria2 is empty and NombreMateria2 != NombreMateria1 %}
                {% if allAlumnos.calificacionE2 is not empty and allAlumnos.calificacionE2 is defined and allAlumnos.calificacionE2 != "0" and allAlumnos.calificacionE2 != ":=0" %}
                  {% set NombreMateria2 = allAlumnos.calificacionE2|split(':=')[0] %}
                  {% set IntMaterias = IntMaterias + 1 %}
                {% endif %}
                {% if NombreMateria3 is empty and NombreMateria3 != NombreMateria1 %}
                  {% if allAlumnos.calificacionE3 is not empty and allAlumnos.calificacionE3 is defined and allAlumnos.calificacionE3 != "0" and allAlumnos.calificacionE3 != ":=0" %}
                    {% set NombreMateria3 = allAlumnos.calificacionE3|split(':=')[0] %}
                    {% set IntMaterias = IntMaterias + 1 %}
                  {% endif %}
                {% endif %}
              {% elseif NombreMateria3 is empty and NombreMateria3 != NombreMateria2 and NombreMateria3 != NombreMateria1 %}
                {% if allAlumnos.calificacionE3 is not empty and allAlumnos.calificacionE3 is defined and allAlumnos.calificacionE3 != "0" and allAlumnos.calificacionE3 != ":=0" %}
                  {% set NombreMateria3 = allAlumnos.calificacionE3|split(':=')[0] %}
                  {% set IntMaterias = IntMaterias + 1 %}
                {% endif %}
              {% endif %}
            {% endfor %}
    				<tr>
              <th>Turno</th>
    					<th>Alumno</th>
              <th colspan="{{IntMaterias}}">Calificacion de Entrada</th>
              <th colspan="{{IntMaterias}}">Calificacion de Salida</th>
    					<th colspan="{{IntMaterias - 1}}">Maestro a cargo</th>
              <th>Porcentaje de mejora</th>
              <th colspan="{{IntMaterias - 1}}">Porcentaje de mejora por materia</th>
    				</tr>
            <tr>
              <th>||</th>
    					<th>||</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
              <th>Promedio</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
              <th>Promedio</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
              <th>%</th>
              {% if NombreMateria1 is not empty %}
                <th>{{NombreMateria1}}</th>
              {% endif %}
              {% if NombreMateria2 is not empty %}
                <th>{{NombreMateria2}}</th>
              {% endif %}
              {% if NombreMateria3 is not empty %}
                <th>{{NombreMateria3}}</th>
              {% endif %}
    				</tr>
    			</thead>
    			<tbody>
            <tr>
              <td rowspan="{{reporte|length + 2}}">{{turno}}</td>
            </tr>
            {% for alumno in reporte %}
              {% if alumno.calificacionE1 is not empty and alumno.calificacionE1 is defined and alumno.calificacionE1 != "0" and alumno.calificacionE1 != ":=0" %}
                {% set CalifiTempo = alumno.calificacionE1|split(':=') %}
                <tr>
                <td>{{alumno.nombre}}</td>
                {% if NombreMateria1 == CalifiTempo[0] %}
                  {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                  {% set CalifiTempoE1 = CalifiTempo[1] %}
                  {% elseif NombreMateria2 == CalifiTempo[0] %}
                  {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                  {% set CalifiTempoE2 = CalifiTempo[1] %}
                  {% elseif NombreMateria3 == CalifiTempo[0] %}
                  {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                  {% set CalifiTempoE3 = CalifiTempo[1] %}
                {% endif %}
                {% if alumno.maestros[0] is defined and alumno.maestros[0] is not empty %}
                  {% if NombreMateria1 == alumno.maestros[0].materias.nombre %}
                    {% set Maestro1 = alumno.maestros[0].nombre %}
                  {% elseif NombreMateria2 == alumno.maestros[0].materias.nombre %}
                    {% set Maestro2 = alumno.maestros[0].nombre %}
                  {% elseif NombreMateria3 == alumno.maestros[0].materias.nombre %}
                    {% set Maestro3 = alumno.maestros[0].nombre %}
                  {% endif %}
                {% endif %}
                {% set AlumnosPGE1 = AlumnosPGE1 + 1 %}
              {% endif %}
              {% if alumno.calificacionE2 is not empty and alumno.calificacionE2 is defined and alumno.calificacionE2 != "0" and alumno.calificacionE2 != ":=0" %}
                {% set CalifiTempo = alumno.calificacionE2|split(':=') %}
                {% if NombreMateria1 == CalifiTempo[0] %}
                  {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                  {% set CalifiTempoE1 = CalifiTempo[1] %}
                  {% elseif NombreMateria2 == CalifiTempo[0] %}
                  {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                  {% set CalifiTempoE2 = CalifiTempo[1] %}
                  {% elseif NombreMateria3 == CalifiTempo[0] %}
                  {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                  {% set CalifiTempoE3 = CalifiTempo[1] %}
                {% endif %}
                {% if alumno.maestros[1] is defined and alumno.maestros[1] is not empty %}
                  {% if NombreMateria1 == alumno.maestros[1].materias.nombre %}
                    {% set Maestro1 = alumno.maestros[1].nombre %}
                  {% elseif NombreMateria2 == alumno.maestros[1].materias.nombre %}
                    {% set Maestro2 = alumno.maestros[1].nombre %}
                  {% elseif NombreMateria3 == alumno.maestros[1].materias.nombre %}
                    {% set Maestro3 = alumno.maestros[1].nombre %}
                  {% endif %}
                {% endif %}
                {% set AlumnosPGE2 = AlumnosPGE2 + 1 %}
              {% endif %}
              {% if alumno.calificacionE3 is not empty and alumno.calificacionE3 is defined and alumno.calificacionE3 != "0" and alumno.calificacionE3 != ":=0" %}
                {% set CalifiTempo = alumno.calificacionE3|split(':=') %}
                {% if NombreMateria1 == CalifiTempo[0] %}
                  {% set CalifiE1 = CalifiE1 + CalifiTempo[1] %}
                  {% set CalifiTempoE1 = CalifiTempo[1] %}
                  {% elseif NombreMateria2 == CalifiTempo[0] %}
                  {% set CalifiE2 = CalifiE2 + CalifiTempo[1] %}
                  {% set CalifiTempoE2 = CalifiTempo[1] %}
                  {% elseif NombreMateria3 == CalifiTempo[0] %}
                  {% set CalifiE3 = CalifiE3 + CalifiTempo[1] %}
                  {% set CalifiTempoE3 = CalifiTempo[1] %}
                {% endif %}
                {% if alumno.maestros[2] is defined and alumno.maestros[2] is not empty %}
                  {% if NombreMateria1 == alumno.maestros[2].materias.nombre %}
                    {% set Maestro1 = alumno.maestros[2].nombre %}
                  {% elseif NombreMateria2 == alumno.maestros[2].materias.nombre %}
                    {% set Maestro2 = alumno.maestros[2].nombre %}
                  {% elseif NombreMateria3 == alumno.maestros[2].materias.nombre %}
                    {% set Maestro3 = alumno.maestros[2].nombre %}
                  {% endif %}
                {% endif %}
                {% set AlumnosPGE3 = AlumnosPGE3 + 1 %}
              {% endif %}
              {% if CalifiTempoE1 is defined %}
                <td>{{ CalifiTempoE1|slice(0, 5)}}</td>
              {% else %}
                <td>{{ CalifiTempoE1}}</td>
              {% endif %}
              {% if CalifiTempoE2 is defined %}
                <td>{{ CalifiTempoE2|slice(0, 5)}}</td>
              {% else %}
                <td>{{ CalifiTempoE2}}</td>
              {% endif %}
              {% if CalifiTempoE3 is defined %}
                <td>{{ CalifiTempoE3|slice(0, 5)}}</td>
              {% else %}
                <td>{{ CalifiTempoE3}}</td>
              {% endif %}
              {% if (CalifiTempoE1 + CalifiTempoE2 + CalifiTempoE3) != 0 %}
                {% set PromedioTempoE = (CalifiTempoE1 + CalifiTempoE2 + CalifiTempoE3) / (IntMaterias - 1) %}
                <td>{{PromedioTempoE|slice(0, 5)}}</td>
                {% else %}
                <td>0</td>
              {% endif %}
              {% if alumno.calificacionS1 is not empty and alumno.calificacionS1 is defined and alumno.calificacionS1 != "0" and alumno.calificacionS1 != ":=0" %}
                {% set CalifiTempo = alumno.calificacionS1|split(':=') %}
                {% if NombreMateria1 == CalifiTempo[0] %}
                  {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                  {% set CalifiTempoS1 = CalifiTempo[1] %}
                  {% elseif NombreMateria2 == CalifiTempo[0] %}
                  {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                  {% set CalifiTempoS2 = CalifiTempo[1] %}
                  {% elseif NombreMateria3 == CalifiTempo[0] %}
                  {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                  {% set CalifiTempoS3 = CalifiTempo[1] %}
                {% endif %}
                {% set AlumnosPGS1 = AlumnosPGS1 + 1 %}
              {% endif %}
              {% if alumno.calificacionS2 is not empty and alumno.calificacionS2 is defined and alumno.calificacionS2 != "0" and alumno.calificacionS2 != ":=0" %}
                {% set CalifiTempo = alumno.calificacionS2|split(':=') %}
                {% if NombreMateria1 == CalifiTempo[0] %}
                  {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                  {% set CalifiTempoS1 = CalifiTempo[1] %}
                  {% elseif NombreMateria2 == CalifiTempo[0] %}
                  {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                  {% set CalifiTempoS2 = CalifiTempo[1] %}
                  {% elseif NombreMateria3 == CalifiTempo[0] %}
                  {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                  {% set CalifiTempoS3 = CalifiTempo[1] %}
                {% endif %}
                {% set AlumnosPGS2 = AlumnosPGS2 + 1 %}
              {% endif %}
              {% if alumno.calificacionS3 is not empty and alumno.calificacionS3 is defined and alumno.calificacionS3 != "0" and alumno.calificacionS3 != ":=0" %}
                {% set CalifiTempo = alumno.calificacionS3|split(':=') %}
                {% if NombreMateria1 == CalifiTempo[0] %}
                  {% set CalifiS1 = CalifiS1 + CalifiTempo[1] %}
                  {% set CalifiTempoS1 = CalifiTempo[1] %}
                  {% elseif NombreMateria2 == CalifiTempo[0] %}
                  {% set CalifiS2 = CalifiS2 + CalifiTempo[1] %}
                  {% set CalifiTempoS2 = CalifiTempo[1] %}
                  {% elseif NombreMateria3 == CalifiTempo[0] %}
                  {% set CalifiS3 = CalifiS3 + CalifiTempo[1] %}
                  {% set CalifiTempoS3 = CalifiTempo[1] %}
                {% endif %}
                {% set AlumnosPGS3 = AlumnosPGS3 + 1 %}
              {% endif %}
              {% if CalifiTempoS1 is defined %}
                <td>{{ CalifiTempoS1|slice(0, 5)}}</td>
              {% else %}
                <td>{{ CalifiTempoS1}}</td>
              {% endif %}
              {% if CalifiTempoS2 is defined %}
                <td>{{ CalifiTempoS2|slice(0, 5)}}</td>
              {% else %}
                <td>{{ CalifiTempoS2}}</td>
              {% endif %}
              {% if CalifiTempoS3 is defined %}
                <td>{{ CalifiTempoS3|slice(0, 5)}}</td>
              {% else %}
                <td>{{ CalifiTempoS3}}</td>
              {% endif %}
              {% if (CalifiTempoS1 + CalifiTempoS2 + CalifiTempoS3) != 0 %}
                {% set PromedioTempoS = (CalifiTempoS1 + CalifiTempoS2 + CalifiTempoS3) / (IntMaterias - 1) %}
                <td>{{PromedioTempoS|slice(0, 5)}}</td>
                {% else %}
                <td>0</td>
              {% endif %}
              <td>{{Maestro1}}</td>
              <td>{{Maestro2}}</td>
              <td>{{Maestro3}}</td>
              {% set PorcentajeTempo = PromedioTempoS - PromedioTempoE %}
              {% if PorcentajeTempo >= 0 %}
                {% if PorcentajeTempo == 0 %}
                  <td>
                    {{PorcentajeTempo}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if PromedioTempoE == 0 %}
                  {{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((PorcentajeTempo / PromedioTempoE) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set PorcentajeTempo = PromedioTempoE - PromedioTempoS %}
                {% if PromedioTempoE == 0 %}
                  -{{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((PorcentajeTempo / PromedioTempoE) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# porsentajes para materia 1 #}
              {% set PorcentajeTempo = CalifiTempoS1 - CalifiTempoE1 %}
              {% if PorcentajeTempo >= 0 %}
                {% if PorcentajeTempo == 0 %}
                  <td>
                    {{PorcentajeTempo}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if CalifiTempoE1 == 0 %}
                  {{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((PorcentajeTempo / CalifiTempoE1) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set PorcentajeTempo = CalifiTempoE1 - CalifiTempoS1 %}
                {% if CalifiTempoE1 == 0 %}
                  -{{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((PorcentajeTempo / CalifiTempoE1) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# fin de porsentajes para materia 1 #}
              {# porsentajes para materia 2 #}
              {% set PorcentajeTempo = CalifiTempoS2 - CalifiTempoE2 %}
              {% if PorcentajeTempo >= 0 %}
                {% if PorcentajeTempo == 0 %}
                  <td>
                    {{PorcentajeTempo}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if CalifiTempoE2 == 0 %}
                  {{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((PorcentajeTempo / CalifiTempoE2) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set PorcentajeTempo = CalifiTempoE2 - CalifiTempoS2 %}
                {% if CalifiTempoE2 == 0 %}
                  -{{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((PorcentajeTempo / CalifiTempoE2) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# fin de porsentajes para materia 2 #}
              {# porsentajes para materia 3 #}
              {% set PorcentajeTempo = CalifiTempoS3 - CalifiTempoE3 %}
              {% if PorcentajeTempo >= 0 %}
                {% if PorcentajeTempo == 0 %}
                  <td>
                    {{PorcentajeTempo}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if CalifiTempoE3 == 0 %}
                  {{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((PorcentajeTempo / CalifiTempoE3) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set PorcentajeTempo = CalifiTempoE3 - CalifiTempoS3 %}
                {% if CalifiTempoE3 == 0 %}
                  -{{ ((PorcentajeTempo / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((PorcentajeTempo / CalifiTempoE3) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# fin de porsentajes para materia 3 #}
              </tr>
            {% endfor %}
            <tr>
              <td>total</td>
              {% if CalifiE1 != 0 %}
              {% set CalifiE1 = CalifiE1 / AlumnosPGE1 %}
                <td>{{CalifiE1|slice(0, 5)}}</td>
              {% else %}
                <td>{{CalifiE1}}</td>
              {% endif %}
              {% if CalifiE2 != 0 %}
              {% set CalifiE2 = CalifiE2 / AlumnosPGE2 %}
                <td>{{CalifiE2|slice(0, 5)}}</td>
              {% else %}
                <td>{{CalifiE2}}</td>
              {% endif %}
              {% if CalifiE3 != 0 %}
              {% set CalifiE3 = CalifiE3 / AlumnosPGE3 %}
                <td>{{CalifiE3|slice(0, 5)}}</td>
              {% else %}
                <td>{{CalifiE3}}</td>
              {% endif %}
              {% if (CalifiE1 + CalifiE2 + CalifiE3)  != 0 %}
                {% set PromedioE = (CalifiE1 + CalifiE2 + CalifiE3) / (IntMaterias - 1) %}
              {% endif %}
              <td>{{PromedioE|slice(0, 5)}}</td>
              {% if CalifiS1 != 0 %}
              {% set CalifiS1 = CalifiS1 / AlumnosPGS1 %}
                <td>{{CalifiS1|slice(0, 5)}}</td>
              {% else %}
                <td>{{CalifiS1}}</td>
              {% endif %}
              {% if CalifiS2 != 0 %}
              {% set CalifiS2 = CalifiS2 / AlumnosPGS2 %}
                <td>{{CalifiS2|slice(0, 5)}}</td>
              {% else %}
                <td>{{CalifiS2}}</td>
              {% endif %}
              {% if CalifiS3 != 0 %}
              {% set CalifiS3 = CalifiS3 / AlumnosPGS3 %}
                <td>{{CalifiS3|slice(0, 5)}}</td>
              {% else %}
                <td>{{CalifiS3}}</td>
              {% endif %}
              {% if (CalifiS1 + CalifiS2 + CalifiS3) != 0 %}
                {% set PromedioS = (CalifiS1 + CalifiS2 + CalifiS3) / (IntMaterias - 1) %}
              {% endif %}
              <td>{{PromedioS|slice(0, 5)}}</td>
              <td>{{Maestro1}}</td>
              <td>{{Maestro2}}</td>
              <td>{{Maestro3}}</td>
              {% set Porcentaje = PromedioS - PromedioE %}
              {% if Porcentaje >= 0 %}
                {% if Porcentaje == 0 %}
                  <td>
                    {{Porcentaje}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if PromedioE == 0 %}
                  {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((Porcentaje / PromedioE) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set Porcentaje = PromedioE - PromedioS %}
                {% if PromedioE == 0 %}
                  -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((Porcentaje / PromedioE) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# porsentajes para materia 1 #}
              {% set Porcentaje = CalifiS1 - CalifiE1 %}
              {% if Porcentaje >= 0 %}
                {% if Porcentaje == 0 %}
                  <td>
                    {{Porcentaje}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if CalifiE1 == 0 %}
                  {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((Porcentaje / CalifiE1) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set Porcentaje = CalifiE1 - CalifiS1 %}
                {% if CalifiE1 == 0 %}
                  -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((Porcentaje / CalifiE1) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# fin de porsentajes para materia 1 #}
              {# porsentajes para materia 2 #}
              {% set Porcentaje = CalifiS2 - CalifiE2 %}
              {% if Porcentaje >= 0 %}
                {% if Porcentaje == 0 %}
                  <td>
                    {{Porcentaje}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if CalifiE2 == 0 %}
                  {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((Porcentaje / CalifiE2) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set Porcentaje = CalifiE2 - CalifiS2 %}
                {% if CalifiE2 == 0 %}
                  -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((Porcentaje / CalifiE2) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# fin de porsentajes para materia 2 #}
              {# porsentajes para materia 3 #}
              {% set Porcentaje = CalifiS3 - CalifiE3 %}
              {% if Porcentaje >= 0 %}
                {% if Porcentaje == 0 %}
                  <td>
                    {{Porcentaje}}%
                  </td>
                {% else %}
                  <td class="text-success">
                {% if CalifiE3 == 0 %}
                  {{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  {{ ((Porcentaje / CalifiE3) * 100)|slice(0, 5) }}%
                {% endif %}
                  </td>
                {% endif %}
              {% else %}
                <td class="text-danger" >
                {% set Porcentaje = CalifiE3 - CalifiS3 %}
                {% if CalifiE3 == 0 %}
                  -{{ ((Porcentaje / 1) * 100)|slice(0, 5) }}%
                {% else %}
                  -{{ ((Porcentaje / CalifiE3) * 100)|slice(0, 5) }}%
                {% endif %}
                </td>
              {% endif %}
              {# fin de porsentajes para materia 3 #}
              {% set AlumnosPGE1 = 0 %}
        			{% set AlumnosPGE2 = 0 %}
        			{% set AlumnosPGE3 = 0 %}
        			{% set AlumnosPGS1 = 0 %}
        			{% set AlumnosPGS2 = 0 %}
        			{% set AlumnosPGS3 = 0 %}
              {% set CalifiE1 = 0 %}
              {% set CalifiE2 = 0 %}
              {% set CalifiE3 = 0 %}
              {% set CalifiS1 = 0 %}
              {% set CalifiS2 = 0 %}
              {% set CalifiS3 = 0 %}
              {% set PromedioE = 0 %}
              {% set PromedioS = 0 %}
            </tr>
      			{% set AlumnosPGE1 = 0 %}
      			{% set AlumnosPGE2 = 0 %}
      			{% set AlumnosPGE3 = 0 %}
      			{% set AlumnosPGS1 = 0 %}
      			{% set AlumnosPGS2 = 0 %}
      			{% set AlumnosPGS3 = 0 %}
            {% set CalifiE1 = 0 %}
            {% set CalifiE2 = 0 %}
            {% set CalifiE3 = 0 %}
            {% set CalifiS1 = 0 %}
            {% set CalifiS2 = 0 %}
            {% set CalifiS3 = 0 %}
            {% set PromedioE = 0 %}
            {% set PromedioS = 0 %}
    			</tbody>
    		</table>
    	</div>
    {% endif %}
  </div>
</div>
{% endblock %}
